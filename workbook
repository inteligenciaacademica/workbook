# Adicione a referência à assembly do DocumentFormat.OpenXml
Add-Type -AssemblyName DocumentFormat.OpenXml

# Defina o caminho do arquivo Excel a ser criado
$filePath = "C:\caminho\para\seu\arquivo.xlsx"

# Crie um novo documento Excel
$spreadsheetDocument = [DocumentFormat.OpenXml.Packaging.SpreadsheetDocument]::Create($filePath, [DocumentFormat.OpenXml.SpreadsheetDocumentType]::Workbook)

# Adicione uma planilha ao documento
$workbookPart = $spreadsheetDocument.AddWorkbookPart()
$workbookPart.Workbook = New-Object DocumentFormat.OpenXml.Spreadsheet.Workbook

# Adicione uma planilha ao workbook
$worksheetPart = $workbookPart.AddNewPart([DocumentFormat.OpenXml.Packaging.WorksheetPart]::typeid, "rId1")
$worksheetPart.Worksheet = New-Object DocumentFormat.OpenXml.Spreadsheet.Worksheet
$sheetData = New-Object DocumentFormat.OpenXml.Spreadsheet.SheetData
$worksheetPart.Worksheet.AppendChild($sheetData)

# Crie uma linha na planilha
$row = New-Object DocumentFormat.OpenXml.Spreadsheet.Row
$cell = New-Object DocumentFormat.OpenXml.Spreadsheet.Cell
$cell.DataType = [DocumentFormat.OpenXml.Spreadsheet.CellValues]::String
$cell.CellValue = New-Object DocumentFormat.OpenXml.Spreadsheet.CellValue("Hello, World!")
$row.AppendChild($cell)
$sheetData.AppendChild($row)

# Salve e feche o documento
$workbookPart.Workbook.Save()
$spreadsheetDocument.Close()

Write-Host "O arquivo Excel foi criado com sucesso em: $filePath"
